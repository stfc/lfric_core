!-----------------------------------------------------------------------------
! Copyright (c) 2017,  Met Office, on behalf of HMSO and Queen's Printer
! For further details please refer to the file LICENCE.original which you
! should have received as part of this distribution.
!-----------------------------------------------------------------------------

!>@brief Initialisation of a test field for the IO Mini App
module io_dev_init_fields_alg_mod

  use log_mod,                         only: log_event,         &
                                             log_scratch_space, &
                                             LOG_LEVEL_INFO,    &
                                             LOG_LEVEL_TRACE,   &
                                             LOG_LEVEL_ERROR

  use field_mod,                       only: field_type

  implicit none

  private
  public :: io_dev_init_fields_alg

contains
  !> @details An algorithm for initialising some test fields
  !> @param[inout] density - example of a W3 field
  !> @param[inout] theta - example of a Wtheta field
  !> @param[inout] wind - example of a W2 field
  subroutine io_dev_init_fields_alg(density, theta, wind)

    implicit none

    ! Test fields
    type( field_type ),   intent(inout) :: density
    type( field_type ),   intent(inout) :: theta
    type( field_type ),   intent(inout) :: wind


    call log_event( "io_dev: Initialising test fields", LOG_LEVEL_INFO )
    ! Set the density field values to 1.0
    call invoke( setval_c( density, 1.0_r_def ) )
    ! Set the theta field values to 2.0
    call invoke( setval_c( theta, 2.0_r_def ) )
    ! Set the wind field values to 3.0
    call invoke( setval_c( wind, 3.0_r_def ) )

    call log_event( "io_dev: Initialised test fields", LOG_LEVEL_INFO )

  end subroutine io_dev_init_fields_alg

end module io_dev_init_fields_alg_mod
